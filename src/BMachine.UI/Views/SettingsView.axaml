<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:BMachine.UI.ViewModels"
             xmlns:views="using:BMachine.UI.Views"
             xmlns:converters="using:BMachine.UI.Converters"
             xmlns:shapes="using:Avalonia.Controls.Shapes"
             mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="600"
             x:Class="BMachine.UI.Views.SettingsView">
    
    <UserControl.Resources>
        <converters:BoolToTextConverter x:Key="BoolToInstallText" TrueText="Uninstall" FalseText="Install" />
        <converters:BoolToTextConverter x:Key="BoolToInstallStyle" TrueText="Clear" FalseText="Primary" />
    </UserControl.Resources>

    <UserControl.Styles>
        <Style Selector="RadioButton.Segmented">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <ControlTemplate>
                    <Border Background="{TemplateBinding Background}" CornerRadius="{TemplateBinding CornerRadius}" Padding="{TemplateBinding Padding}">
                         <ContentPresenter Content="{TemplateBinding Content}" 
                                           HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                           VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Border>
                </ControlTemplate>
            </Setter>
            <Setter Property="Transitions">
                <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.15"/>
                    <BrushTransition Property="Foreground" Duration="0:0:0.15"/>
                </Transitions>
            </Setter>
        </Style>
        <Style Selector="RadioButton.Segmented:checked">
            <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/> <!-- Or white/lighter -->
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
             <!-- Add a shadow or border for effect -->
            <Setter Property="Effect">
                <DropShadowEffect BlurRadius="4" Color="Black" Opacity="0.1" OffsetX="0" OffsetY="2"/>
            </Setter>
        </Style>
        <Style Selector="RadioButton.Segmented:pointerover">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
            <Setter Property="Opacity" Value="0.8"/>
        </Style>
    </UserControl.Styles>
    
    <Grid x:Name="Part_RootGrid" RowDefinitions="Auto, *" ColumnDefinitions="300, *" Margin="30" SizeChanged="OnRootGridSizeChanged" Background="{DynamicResource SolidBackgroundFillColorBaseBrush}">
        
        <!-- Header (Compact like Dashboard) -->
        <!-- Header (Compact like Dashboard) -->
        <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Spacing="15" Margin="0,0,0,20">
             <Button Command="{Binding NavigateBackCommand}" 
                     IsVisible="{Binding IsMobileContentOpen}" 
                     Background="Transparent" BorderThickness="0" Padding="5" Cursor="Hand">
                 <PathIcon Data="{StaticResource IconArrowLeft}" Width="24" Height="24" Foreground="{DynamicResource TextPrimaryBrush}"/>
             </Button>
            <TextBlock Text="Control Center" 
                       FontSize="18" FontWeight="SemiBold" 
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource TextPrimaryBrush}"/>
        </StackPanel>

        <!-- Sidebar -->
        <Border x:Name="Part_Sidebar" Grid.Row="1" Grid.Column="0" Margin="0,0,30,0" IsVisible="{Binding IsSidebarVisible}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="10">
                <!-- Title removed from here -->
                
                <!-- Menu Items -->
                <ListBox Background="Transparent" SelectedIndex="{Binding SelectedMenuIndex}">
                    <ListBox.Styles>
                        <Style Selector="ListBoxItem">
                            <Setter Property="Padding" Value="15"/>
                            <Setter Property="CornerRadius" Value="10"/>
                            <Setter Property="Margin" Value="0,5"/>
                            <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
                        </Style>
                        <Style Selector="ListBoxItem:selected">
                            <Setter Property="Background" Value="{DynamicResource AccentBlueBrush}"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="BorderThickness" Value="2,0,0,0"/>
                            <Setter Property="BorderBrush" Value="{DynamicResource AccentBlueBrush}"/>
                        </Style>
                        
                        <!-- Force Primary Button Style Locally -->

                    </ListBox.Styles>
                    
                    <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <PathIcon Data="{StaticResource IconSettings}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                            <TextBlock Text="{Binding Language[Nav.General]}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem>
                    
                    <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <PathIcon Data="{StaticResource IconImage}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                            <TextBlock Text="{Binding Language[Nav.Appearance]}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem>
                    
                    <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <PathIcon Data="{StaticResource IconUser}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                            <TextBlock Text="{Binding Language[Nav.Account]}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem>
                    
                     <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <PathIcon Data="{StaticResource IconExtension}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                            <TextBlock Text="{Binding Language[Nav.Extensions]}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem>

                    <!-- Script Manager Item (Visible) -->
                     <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                             <PathIcon Data="{StaticResource IconScript}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                             <TextBlock Text="Script Manager" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem> 
                    
                    <!-- Paths Manager Item -->
                    <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                             <PathIcon Data="{StaticResource IconFolder}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                             <TextBlock Text="Paths" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem>

                    <!-- About Item -->
                    <ListBoxItem>
                        <StackPanel Orientation="Horizontal" Spacing="15">
                             <PathIcon Data="{StaticResource IconInfoCircle}" Width="18" Height="18" Foreground="{Binding $parent[ListBoxItem].Foreground}"/>
                             <TextBlock Text="About" VerticalAlignment="Center" FontWeight="SemiBold"/>
                        </StackPanel>
                    </ListBoxItem>
                </ListBox>
            </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- Content Area Wrapper -->
        <Grid x:Name="Part_ContentWrapper" Grid.Row="1" Grid.Column="1" IsVisible="{Binding IsContentVisible}">
            <!-- Content Area (Appearance) -->
            <Border Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True" 
                    IsVisible="{Binding IsAppearanceSelected}">
             <!-- ... Appearance Content ... -->
             <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Spacing="25" Margin="30">
                    <!-- Header Removed -->
                    
                    <StackPanel Spacing="20">
                         <!-- Theme Mode -->
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="{Binding Language[Appearance.Mode]}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="{Binding Language[Appearance.ModeDesc]}" FontSize="12" Foreground="#999"/>
                            </StackPanel>
                            <!-- Theme Segmented Control -->
                            <Border Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="8" BorderBrush="{DynamicResource SeparatorBrush}" BorderThickness="1" Padding="2" Width="140" HorizontalAlignment="Right">
                                <Grid ColumnDefinitions="*,*">
                                    <RadioButton Grid.Column="0" Content="Light" GroupName="ThemeGroup" 
                                                 IsChecked="{Binding SelectedThemeIndex, Converter={x:Static converters:IndexToBoolConverter.Instance}, ConverterParameter=0}"
                                                 Classes="Segmented"/>
                                    <RadioButton Grid.Column="1" Content="Dark" GroupName="ThemeGroup"
                                                 IsChecked="{Binding SelectedThemeIndex, Converter={x:Static converters:IndexToBoolConverter.Instance}, ConverterParameter=1}"
                                                 Classes="Segmented"/>
                                </Grid>
                            </Border>
                        </Grid>

                        <!-- Custom Backgrounds -->
                        <StackPanel Spacing="10" Margin="0,10,0,0">
                             <TextBlock Text="Custom Background (Dark/Light)" FontWeight="SemiBold"/>
                             <Grid ColumnDefinitions="*, *" ShowGridLines="False">
                                <Grid Grid.Column="0" ColumnDefinitions="Auto, *" Margin="0,0,5,0">
                                    <TextBlock Text="Dark Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomDarkBackgroundColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                                <Grid Grid.Column="1" ColumnDefinitions="Auto, *" Margin="5,0,0,0">
                                    <TextBlock Text="Light Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomLightBackgroundColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                             </Grid>
                        </StackPanel>

                        <!-- Custom Card Border -->
                        <StackPanel Spacing="10" Margin="0,10,0,0">
                             <TextBlock Text="Custom Card Border (Dark/Light)" FontWeight="SemiBold"/>
                             <TextBlock Text="Pilih warna border untuk panel/kartu." FontSize="12" Foreground="#999"/>
                             <Grid ColumnDefinitions="*, *" ShowGridLines="False">
                                <Grid Grid.Column="0" ColumnDefinitions="Auto, *" Margin="0,0,5,0">
                                    <TextBlock Text="Dark Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomDarkBorderColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                                <Grid Grid.Column="1" ColumnDefinitions="Auto, *" Margin="5,0,0,0">
                                    <TextBlock Text="Light Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomLightBorderColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                             </Grid>
                        </StackPanel>

                        <!-- Custom Card Background -->
                        <StackPanel Spacing="10" Margin="0,10,0,0">
                             <TextBlock Text="Custom Card Background (Dark/Light)" FontWeight="SemiBold"/>
                             <TextBlock Text="Pilih warna latar belakang kartu." FontSize="12" Foreground="#999"/>
                             <Grid ColumnDefinitions="*, *" ShowGridLines="False">
                                <Grid Grid.Column="0" ColumnDefinitions="Auto, *" Margin="0,0,5,0">
                                    <TextBlock Text="Dark Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomDarkCardBgColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                                <Grid Grid.Column="1" ColumnDefinitions="Auto, *" Margin="5,0,0,0">
                                    <TextBlock Text="Light Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomLightCardBgColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                             </Grid>
                        </StackPanel>

                        <!-- Custom Terminal Background -->
                        <StackPanel Spacing="10" Margin="0,10,0,0">
                             <TextBlock Text="Custom Terminal Background (Dark/Light)" FontWeight="SemiBold"/>
                             <TextBlock Text="Pilih warna latar belakang terminal." FontSize="12" Foreground="#999"/>
                             <Grid ColumnDefinitions="*, *" ShowGridLines="False">
                                <Grid Grid.Column="0" ColumnDefinitions="Auto, *" Margin="0,0,5,0">
                                    <TextBlock Text="Dark Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomDarkTerminalBgColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                                <Grid Grid.Column="1" ColumnDefinitions="Auto, *" Margin="5,0,0,0">
                                    <TextBlock Text="Light Mode" VerticalAlignment="Center" Width="80"/>
                                    <ColorPicker Grid.Column="1" Color="{Binding CustomLightTerminalBgColor}" Margin="5,0,0,0" HorizontalAlignment="Stretch"/>
                                </Grid>
                             </Grid>
                        </StackPanel>
                        
                        <Border Height="1" Background="{DynamicResource SeparatorBrush}" Margin="0,10"/>

                        <!-- Global Accent Color -->
                        <StackPanel Spacing="10">
                             <TextBlock Text="Global Accent Color" FontWeight="SemiBold"/>
                             <TextBlock Text="Warna utama aplikasi (Tombol, Link, Indikator)." FontSize="12" Foreground="#999"/>
                             
                             <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto">
                                 <TextBlock Grid.Row="0" Text="Accent Color" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 <ComboBox Grid.Row="0" Grid.Column="1" SelectedItem="{Binding AccentColor}" ItemsSource="{Binding WidgetColorOptions}" Width="150" Cursor="Hand">
                                     <ComboBox.ItemTemplate>
                                         <DataTemplate>
                                             <StackPanel Orientation="Horizontal" Spacing="8">
                                                 <Border Width="12" Height="12" CornerRadius="6" Background="{Binding Brush}"/>
                                                 <TextBlock Text="{Binding Name}"/>
                                             </StackPanel>
                                         </DataTemplate>
                                     </ComboBox.ItemTemplate>
                                 </ComboBox>
                                 
                                 <!-- Custom Picker for Accent -->
                                 <ColorPicker Grid.Row="1" Grid.Column="1" IsVisible="{Binding IsAccentCustom}" 
                                             Color="{Binding CustomAccentColor}" Margin="0,10,0,0"/>
                             </Grid>
                        </StackPanel>
                        
                        <Border Height="1" Background="{DynamicResource SeparatorBrush}"/>

                        <!-- Navigation Button Style -->
                        <StackPanel Spacing="15" Margin="0,10,0,0">
                             <StackPanel Spacing="5">
                                 <TextBlock Text="Navigation Button Style" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="Sesuaikan tampilan tombol navigasi (Dashboard/Batch)." FontSize="12" Foreground="#999"/>
                             </StackPanel>

                             <!-- Width -->
                             <Grid ColumnDefinitions="*, 120">
                                 <StackPanel>
                                     <TextBlock Text="Button Width" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 </StackPanel>
                                 <NumericUpDown Grid.Column="1" Value="{Binding NavButtonWidth}" Minimum="80" Maximum="250" Increment="1" FormatString="0" />
                             </Grid>

                             <!-- Height -->
                             <Grid ColumnDefinitions="*, 120">
                                 <StackPanel>
                                     <TextBlock Text="Button Height" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 </StackPanel>
                                 <NumericUpDown Grid.Column="1" Value="{Binding NavButtonHeight}" Minimum="20" Maximum="80" Increment="1" FormatString="0" />
                             </Grid>

                             <!-- Corner Radius -->
                             <Grid ColumnDefinitions="*, 120">
                                 <StackPanel>
                                     <TextBlock Text="Corner Radius" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 </StackPanel>
                                 <NumericUpDown Grid.Column="1" Value="{Binding NavCornerRadius}" Minimum="0" Maximum="40" Increment="1" FormatString="0" />
                             </Grid>

                             <!-- Nav Style Segmented -->
                             <Grid ColumnDefinitions="*, 200">
                                 <StackPanel>
                                     <TextBlock Text="Button Type" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 </StackPanel>
                                 <Border Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="8" BorderBrush="{DynamicResource SeparatorBrush}" BorderThickness="1" Padding="2">
                                     <Grid ColumnDefinitions="*,*">
                                         <RadioButton Grid.Column="0" Content="Icon" GroupName="NavStyleGroup" 
                                                     IsChecked="{Binding NavStyleIndex, Converter={x:Static converters:IndexToBoolConverter.Instance}, ConverterParameter=0}"
                                                     Classes="Segmented"/>
                                         <RadioButton Grid.Column="1" Content="Text" GroupName="NavStyleGroup"
                                                     IsChecked="{Binding NavStyleIndex, Converter={x:Static converters:IndexToBoolConverter.Instance}, ConverterParameter=1}"
                                                     Classes="Segmented"/>
                                     </Grid>
                                 </Border>
                             </Grid>

                             <!-- Custom Text (If Text Mode) -->
                             <Grid IsVisible="{Binding NavStyleIndex, Converter={x:Static converters:IndexToBoolConverter.Instance}, ConverterParameter=1}">
                                 <Grid.ColumnDefinitions>
                                     <ColumnDefinition Width="*"/>
                                     <ColumnDefinition Width="200"/>
                                 </Grid.ColumnDefinitions>
                                 <StackPanel Spacing="10" Grid.Column="0">
                                     <TextBlock Text="Button Texts" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 </StackPanel>
                                 <StackPanel Grid.Column="1" Spacing="5">
                                     <TextBox Text="{Binding NavCustomText}" Watermark="Dashboard" />
                                     <TextBox Text="{Binding NavGdriveText}" Watermark="Driver" />
                                     <TextBox Text="{Binding NavPixelcutText}" Watermark="Pixelcut" />
                                     <TextBox Text="{Binding NavBatchText}" Watermark="Batch" />
                                     <TextBox Text="{Binding NavLockerText}" Watermark="Locker" />
                                 </StackPanel>
                             </Grid>

                             <!-- Font Size -->
                             <Grid ColumnDefinitions="*, 120">
                                 <StackPanel>
                                     <TextBlock Text="Font Size" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 </StackPanel>
                                 <NumericUpDown Grid.Column="1" Value="{Binding NavFontSize}" Minimum="10" Maximum="24" Increment="0.5" FormatString="0.0" />
                             </Grid>
                        </StackPanel>
                        
                        <!-- Toggle Startup -->
                         <Grid ColumnDefinitions="*, Auto" Margin="0,10,0,0">
                            <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="Startup Animation" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="Efek animasi intro saat aplikasi dibuka." FontSize="12" Foreground="#999"/>
                            </StackPanel>
                            <ToggleSwitch Grid.Column="1" IsChecked="{Binding IsStartupAnimationEnabled}" OnContent="On" OffContent="Off"/>
                        </Grid>
                        
                        <!-- Widget Animation Speed -->
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="Kecepatan Animasi Widget" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="Durasi animasi lingkaran pada widget statistik." FontSize="12" Foreground="#999"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedIndex="{Binding SelectedStatSpeedIndex}" Width="150">
                                <ComboBoxItem Content="Mati (Off)"/>
                                <ComboBoxItem Content="Lambat (3s)"/>
                                <ComboBoxItem Content="Normal (1.5s)"/>
                                <ComboBoxItem Content="Cepat (0.5s)"/>
                            </ComboBox>
                        </Grid>
                    </StackPanel>
                    
                    <Border Height="1" Background="#26282C"/>

                    <!-- Widget Colors (Advanced) -->
                    <StackPanel Spacing="15">
                        <StackPanel Spacing="5">
                             <TextBlock Text="Warna Widget Statistik (Advanced)" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                             <TextBlock Text="Kustomisasi warna indikator untuk setiap widget statistik." FontSize="12" Foreground="#999"/>
                        </StackPanel>
                        
                        <!-- Editing -->
                        <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto">
                            <TextBlock Grid.Row="0" Text="{Binding Language[Stats.Editing]}" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <ComboBox Grid.Row="0" Grid.Column="1" SelectedItem="{Binding EditingColor}" ItemsSource="{Binding WidgetColorOptions}" Width="150">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <Border Width="16" Height="16" CornerRadius="8" Background="{Binding Brush}"/>
                                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Grid Grid.Row="1" Grid.Column="1" IsVisible="{Binding IsEditingCustom}" ColumnDefinitions="Auto, *" Margin="0,5,0,0">
                                <TextBlock Text="Pick Color: " VerticalAlignment="Center" Margin="0,0,5,0" FontSize="11" Foreground="#888"/>
                                <ColorPicker Grid.Column="1" Color="{Binding CustomEditingColor}" HorizontalAlignment="Stretch"/>
                            </Grid>
                        </Grid>
                        
                        <!-- Revision -->
                        <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto">
                            <TextBlock Grid.Row="0" Text="{Binding Language[Stats.Revision]}" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <ComboBox Grid.Row="0" Grid.Column="1" SelectedItem="{Binding RevisionColor}" ItemsSource="{Binding WidgetColorOptions}" Width="150">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <Border Width="16" Height="16" CornerRadius="8" Background="{Binding Brush}"/>
                                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Grid Grid.Row="1" Grid.Column="1" IsVisible="{Binding IsRevisionCustom}" ColumnDefinitions="Auto, *" Margin="0,5,0,0">
                                <TextBlock Text="Pick Color: " VerticalAlignment="Center" Margin="0,0,5,0" FontSize="11" Foreground="#888"/>
                                <ColorPicker Grid.Column="1" Color="{Binding CustomRevisionColor}" HorizontalAlignment="Stretch"/>
                            </Grid>
                        </Grid>

                        <!-- Late -->
                        <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto">
                            <TextBlock Grid.Row="0" Text="{Binding Language[Stats.Late]}" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <ComboBox Grid.Row="0" Grid.Column="1" SelectedItem="{Binding LateColor}" ItemsSource="{Binding WidgetColorOptions}" Width="150">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <Border Width="16" Height="16" CornerRadius="8" Background="{Binding Brush}"/>
                                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Grid Grid.Row="1" Grid.Column="1" IsVisible="{Binding IsLateCustom}" ColumnDefinitions="Auto, *" Margin="0,5,0,0">
                                <TextBlock Text="Pick Color: " VerticalAlignment="Center" Margin="0,0,5,0" FontSize="11" Foreground="#888"/>
                                <ColorPicker Grid.Column="1" Color="{Binding CustomLateColor}" HorizontalAlignment="Stretch"/>
                            </Grid>
                        </Grid>

                        <!-- Points -->
                        <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto">
                            <TextBlock Grid.Row="0" Text="{Binding Language[Stats.Points]}" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                            <ComboBox Grid.Row="0" Grid.Column="1" SelectedItem="{Binding PointsColor}" ItemsSource="{Binding WidgetColorOptions}" Width="150">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <Border Width="16" Height="16" CornerRadius="8" Background="{Binding Brush}"/>
                                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Grid Grid.Row="1" Grid.Column="1" IsVisible="{Binding IsPointsCustom}" ColumnDefinitions="Auto, *" Margin="0,5,0,0">
                                <TextBlock Text="Pick Color: " VerticalAlignment="Center" Margin="0,0,5,0" FontSize="11" Foreground="#888"/>
                                <ColorPicker Grid.Column="1" Color="{Binding CustomPointsColor}" HorizontalAlignment="Stretch"/>
                            </Grid>
                        </Grid>
                        
                        <!-- Orb Settings Removed -->
                    </StackPanel>
                    
                    <Button HorizontalAlignment="Right" Content="{Binding Language[General.Save]}" Command="{Binding SaveProfileCommand}" Classes="Primary" Margin="0,20,0,0"/>
                </StackPanel>
             </ScrollViewer>
        </Border>

        <!-- Content Area (General) - Existing -->
        <Border Grid.Row="1" Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True"
                IsVisible="{Binding IsGeneralSelected}">
                <!-- ... General Content ... -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Spacing="25" Margin="30">
                    <!-- Header Removed -->

                    <!-- Settings Items -->
                    <StackPanel Spacing="20">
                        <!-- Language -->
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="{Binding Language[General.Language]}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="{Binding Language[General.LanguageDesc]}" FontSize="12" Foreground="#999" TextWrapping="Wrap"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedIndex="{Binding SelectedLanguageIndex}" Width="150">
                                <ComboBoxItem>English</ComboBoxItem>
                                <ComboBoxItem>Indonesia</ComboBoxItem>
                            </ComboBox>
                        </Grid>
                        
                        <Border Height="1" Background="{DynamicResource SeparatorBrush}"/>

                        <!-- Batch File Filter -->
                        <Grid ColumnDefinitions="*, Auto">
                             <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="File Extensions Filter" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="Masukan ekstensi yang ingin ditampilkan (contoh: .jpg, .png). Kosongkan untuk semua." FontSize="12" Foreground="#999" TextWrapping="Wrap"/>
                             </StackPanel>
                             <TextBox Grid.Column="1" Text="{Binding BatchFileFilter}" Watermark="All (*)" Width="150" HorizontalContentAlignment="Right"/>
                        </Grid>
                        

                        <Border Height="1" Background="{DynamicResource SeparatorBrush}"/>
                        

                        
                        <!-- Storage -->
                        <Grid ColumnDefinitions="*, Auto">
                             <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="{Binding Language[General.Storage]}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="{Binding Language[General.StorageDesc]}" FontSize="12" Foreground="#999" TextWrapping="Wrap"/>
                             </StackPanel>
                             <Button Grid.Column="1" Classes="Clear" Content=">" Foreground="#999"/>
                        </Grid>
                        
                        <Border Height="1" Background="{DynamicResource SeparatorBrush}"/>
                        
                        <!-- Dashboard Visibility -->
                        <StackPanel Spacing="10">
                            <TextBlock Text="Dashboard Visibility" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <Grid ColumnDefinitions="*, Auto" Margin="10,0,0,0">
                                <TextBlock Text="Show GDrive" VerticalAlignment="Center" Foreground="#999"/>
                                <ToggleSwitch Grid.Column="1" IsChecked="{Binding IsGdriveVisible}"/>
                            </Grid>
                            <Grid ColumnDefinitions="*, Auto" Margin="10,0,0,0">
                                <TextBlock Text="Show Pixelcut" VerticalAlignment="Center" Foreground="#999"/>
                                <ToggleSwitch Grid.Column="1" IsChecked="{Binding IsPixelcutVisible}"/>
                            </Grid>
                            <Grid ColumnDefinitions="*, Auto" Margin="10,0,0,0">
                                <TextBlock Text="Show Batch" VerticalAlignment="Center" Foreground="#999"/>
                                <ToggleSwitch Grid.Column="1" IsChecked="{Binding IsBatchVisible}"/>
                            </Grid>
                             <Grid ColumnDefinitions="*, Auto" Margin="10,0,0,0">
                                <TextBlock Text="Show Folder Locker" VerticalAlignment="Center" Foreground="#999"/>
                                <ToggleSwitch Grid.Column="1" IsChecked="{Binding IsFolderLockVisible}"/>
                            </Grid>
                             <!-- <Grid ColumnDefinitions="*, Auto" Margin="10,0,0,0">
                                <TextBlock Text="Show Points" VerticalAlignment="Center" Foreground="#999"/>
                                <ToggleSwitch Grid.Column="1" IsChecked="{Binding IsPointVisible}"/>
                            </Grid> -->
                        </StackPanel>
                        
                        <!-- Refresh Interval Removed (Moved to Account) -->
                        
                        <!-- Shortcut -->
                        <Grid ColumnDefinitions="*, Auto">
                             <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="Menu Shortcut (Advanced)" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="{Binding CurrentShortcut}" FontSize="12" Foreground="{DynamicResource AccentColorBrush}" FontWeight="Bold"/>
                                 <TextBlock Text="Press Record, then input new key/mouse combo." FontSize="11" Foreground="#999" IsVisible="{Binding !IsRecordingShortcut}"/>
                                 <TextBlock Text="LISTENING... Press any key or mouse button!" FontSize="11" Foreground="#ef4444" FontWeight="Bold" IsVisible="{Binding IsRecordingShortcut}"/>
                             </StackPanel>
                             
                             <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Center">
                                 <Button Content="Record New" 
                                         Command="{Binding StartRecordingShortcutCommand}"
                                         IsVisible="{Binding !IsRecordingShortcut}"
                                         Classes="Primary"
                                         HorizontalAlignment="Right"/>
                                         
                                 <Button Content="Cancel (Esc)" 
                                         Command="{Binding CancelRecordingShortcutCommand}"
                                         IsVisible="{Binding IsRecordingShortcut}"
                                         Classes="Accent"
                                         HorizontalAlignment="Right"/>
                             </StackPanel>
                        </Grid>
                        
                        <Border Height="1" Background="{DynamicResource SeparatorBrush}"/>

                        <!-- System Time Sync -->
                        <Grid ColumnDefinitions="*, Auto">
                             <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="Date &amp; Time" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                 <TextBlock Text="Buka pengaturan jam Windows untuk sinkronisasi waktu." FontSize="12" Foreground="#999" TextWrapping="Wrap"/>
                             </StackPanel>
                             <Button Grid.Column="1" Command="{Binding SyncSystemTimeCommand}" Content="Sync Time" Classes="Primary"/>
                        </Grid>
                        
                        <Border Height="1" Background="{DynamicResource SeparatorBrush}"/>
                        
                        <!-- Edit Profile -->
                        <Grid ColumnDefinitions="*, Auto">
                             <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="{Binding Language[General.Profile]}" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                  <TextBlock Text="{Binding Language[General.ProfileDesc]}" FontSize="12" Foreground="#999" TextWrapping="Wrap"/>
                             </StackPanel>
                             <Grid Grid.Column="1" ColumnDefinitions="*, Auto" Margin="0,0,0,10">
                                   <TextBox Grid.Column="0" Width="150" Text="{Binding UserName}" Watermark="Nama Anda" HorizontalContentAlignment="Center"/>
                                   <Button Grid.Column="1" Command="{Binding OpenAvatarSelectionCommand}" 
                                           Width="40" Height="40" CornerRadius="20" Padding="0" Margin="10,0,0,0" 
                                           Background="Transparent" BorderThickness="0" Cursor="Hand" ToolTip.Tip="Change Avatar">
                                       <Border CornerRadius="20" ClipToBounds="True">
                                            <Panel>
                                                <PathIcon Data="{StaticResource IconUser}" Width="20" Height="20" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                             IsVisible="{Binding AvatarImage, Converter={x:Static ObjectConverters.IsNull}}"/>
                                                <Image Source="{Binding AvatarImage}" Stretch="UniformToFill"
                                                       IsVisible="{Binding AvatarImage, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                            </Panel>
                                       </Border>
                                   </Button>
                              </Grid>
                        </Grid>
                         <Button Grid.Column="1" HorizontalAlignment="Right" Content="{Binding Language[General.Save]}" Command="{Binding SaveProfileCommand}" Classes="Primary"/>

                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Content Area (Account / Advanced Integration) -->
        <Border Grid.Row="1" Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True"
                IsVisible="{Binding IsAccountSelected}">
                <!-- ... Account Content ... -->
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Spacing="25" Margin="30">
                     <!-- Header Removed -->
                    <StackPanel Spacing="15">
                        <TextBlock Text="Trello Integration" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        
                        <Grid ColumnDefinitions="150, *" RowDefinitions="Auto, Auto, Auto">
                             <TextBlock Grid.Row="0" Grid.Column="0" Text="API Key:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <Grid Grid.Row="0" Grid.Column="1" ColumnDefinitions="*, Auto" Margin="0,0,0,10">
                                 <TextBox Grid.Column="0" Text="{Binding TrelloApiKey, UpdateSourceTrigger=PropertyChanged}" PasswordChar="*" Watermark="Trello API Key" />
                                 <Button Grid.Column="1" Command="{Binding OpenTrelloAdminCommand}" Content="Get Key" Classes="Clear" Margin="10,0,0,0" ToolTip.Tip="Open Trello Power-Up Admin to generate Key"
                                         IsVisible="{Binding IsTrelloKeyMissing}"/>
                             </Grid>
                             
                             <TextBlock Grid.Row="1" Grid.Column="0" Text="Token:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"
                                        IsVisible="{Binding IsTrelloKeyProvided}"/>
                             <Grid Grid.Row="1" Grid.Column="1" ColumnDefinitions="*, Auto" Margin="0,0,0,10"
                                   IsVisible="{Binding IsTrelloKeyProvided}">
                                 <TextBox Grid.Column="0" Text="{Binding TrelloToken, UpdateSourceTrigger=PropertyChanged}" PasswordChar="*" Watermark="Trello Token"/>
                                 <Button Grid.Column="1" Command="{Binding SmartTrelloActionCommand}" Content="{Binding SmartTrelloButtonText}" Classes="Primary" Margin="10,0,0,0"/>
                             </Grid>
                        </Grid>
                        
                        <TextBlock Text="Google Integration" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,10,0,0"/>
                        
                        <Grid ColumnDefinitions="150, *" RowDefinitions="Auto, Auto, Auto, Auto, Auto">
                             <TextBlock Grid.Row="0" Grid.Column="0" Text="Credentials JSON:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <Grid Grid.Row="0" Grid.Column="1" ColumnDefinitions="*, Auto" Margin="0,0,0,10">
                                 <TextBox Grid.Column="0" Text="{Binding GoogleCredsPath}" Watermark="Path to json credentials"/>
                                 <Button Grid.Column="1" Classes="Primary" Margin="10,0,0,0" Click="OnBrowseCredsClick" Padding="10,5">
                                      <PathIcon Data="{StaticResource IconFolder}" Width="16" Height="16"/>
                                 </Button>
                             </Grid>
                             
                             <TextBlock Grid.Row="1" Grid.Column="0" Text="Sheet ID:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding GoogleSheetId}" Watermark="Google Sheet ID" Margin="0,0,0,10"/>
                             
                             <TextBlock Grid.Row="2" Grid.Column="0" Text="Worksheet Name:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SheetName}" Watermark="e.g. Sheet1" Margin="0,0,0,10"/>

                             
                             <TextBlock Grid.Row="3" Grid.Column="0" Text="Column/Row:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <Grid Grid.Row="3" Grid.Column="1" ColumnDefinitions="*, *" Margin="0,0,0,10">
                                 <AutoCompleteBox Grid.Column="0" ItemsSource="{Binding SheetColumns}" SelectedItem="{Binding SheetColumn}" Watermark="Col" HorizontalAlignment="Stretch" Margin="0,0,5,0" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                 <AutoCompleteBox Grid.Column="1" ItemsSource="{Binding SheetRows}" SelectedItem="{Binding SheetRow}" Watermark="Row" HorizontalAlignment="Stretch" Margin="5,0,0,0" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                             </Grid>

                             
                             <!-- LEADERBOARD CONFIG -->
                             <TextBlock Grid.Row="4" Grid.Column="0" Text="Leaderboard Range:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding LeaderboardRange}" Watermark="e.g. A2:C10" HorizontalAlignment="Stretch" Margin="0,0,0,10"/>
                        </Grid>
                        
                        <TextBlock Text="Board Synchronization" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,10,0,0"/>
                         <TextBlock Text="Simulated dropdown contents for now." FontSize="12" Foreground="Gray"/>
                        
                        <!-- Board Configs (Only Visible if Connected) -->
                        <StackPanel IsVisible="{Binding IsTrelloConnected}">
                             <Grid ColumnDefinitions="150, *" RowDefinitions="Auto, Auto, Auto, Auto, Auto">
                                   <!-- Editing -->
                                  <TextBlock Grid.Row="0" Grid.Column="0" Text="Editing Board/List:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                  <Grid Grid.Row="0" Grid.Column="1" ColumnDefinitions="*, *" Margin="0,0,0,10">
                                      <AutoCompleteBox Grid.Column="0" ItemsSource="{Binding MockBoards}" SelectedItem="{Binding SelectedEditingBoard}" ValueMemberBinding="{Binding Name}" HorizontalAlignment="Stretch" Watermark="Select Board" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                      <AutoCompleteBox Grid.Column="1" ItemsSource="{Binding EditingLists}" SelectedItem="{Binding SelectedEditingList}" ValueMemberBinding="{Binding Name}" HorizontalAlignment="Stretch" Watermark="Select List" Margin="10,0,0,0" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                  </Grid>
                                  
                                   <!-- Revision -->
                                  <TextBlock Grid.Row="1" Grid.Column="0" Text="Revisi Board/List:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                  <Grid Grid.Row="1" Grid.Column="1" ColumnDefinitions="*, *" Margin="0,0,0,10">
                                      <AutoCompleteBox Grid.Column="0" ItemsSource="{Binding MockBoards}" SelectedItem="{Binding SelectedRevisionBoard}" ValueMemberBinding="{Binding Name}" HorizontalAlignment="Stretch" Watermark="Select Board" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                      <AutoCompleteBox Grid.Column="1" ItemsSource="{Binding RevisionLists}" SelectedItem="{Binding SelectedRevisionList}" ValueMemberBinding="{Binding Name}" HorizontalAlignment="Stretch" Watermark="Select List" Margin="10,0,0,0" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                  </Grid>
                                  
                                   <!-- Late/Susulan -->
                                  <TextBlock Grid.Row="2" Grid.Column="0" Text="Susulan Board/List:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                  <Grid Grid.Row="2" Grid.Column="1" ColumnDefinitions="*, *" Margin="0,0,0,10">
                                      <AutoCompleteBox Grid.Column="0" ItemsSource="{Binding MockBoards}" SelectedItem="{Binding SelectedLateBoard}" ValueMemberBinding="{Binding Name}" HorizontalAlignment="Stretch" Watermark="Select Board" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                      <AutoCompleteBox Grid.Column="1" ItemsSource="{Binding LateLists}" SelectedItem="{Binding SelectedLateList}" ValueMemberBinding="{Binding Name}" HorizontalAlignment="Stretch" Watermark="Select List" Margin="10,0,0,0" FilterMode="Contains" MinimumPrefixLength="0" GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                  </Grid>
    
                                  <!-- QC Move Board -->
                                  <TextBlock Grid.Row="3" Grid.Column="0" Text="Target Move Board:" VerticalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                  <Grid Grid.Row="3" Grid.Column="1" Margin="0,0,0,10">
                                      <AutoCompleteBox ItemsSource="{Binding MockBoards}" 
                                                SelectedItem="{Binding SelectedQcBoard}" 
                                                ValueMemberBinding="{Binding Name}" 
                                                HorizontalAlignment="Stretch" 
                                                Watermark="Select Auto-Move Board"
                                                FilterMode="Contains" MinimumPrefixLength="0"
                                                GotFocus="AutoCompleteBox_GotFocus" MaxDropDownHeight="160"/>
                                  </Grid>
                             </Grid>
                        </StackPanel>

                        <!-- Disconnected State (Visible if Not Connected) -->
                        <Border IsVisible="{Binding !IsTrelloConnected}" 
                                Background="#1A1A1A" CornerRadius="12" Padding="20" Margin="0,5,0,0" BorderBrush="#333" BorderThickness="1">
                             <StackPanel Spacing="10" HorizontalAlignment="Center">
                                 <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                                     <PathIcon Data="{StaticResource IconAlertTriangle}" Width="24" Height="24" Foreground="#FF5555"/>
                                     <TextBlock Text="Not Connected" FontSize="18" FontWeight="Bold" Foreground="#666" VerticalAlignment="Center"/>
                                 </StackPanel>
                                 <TextBlock Text="Connect your Trello Account above to configure Boards &amp; Lists." Foreground="#555" FontSize="13"/>
                             </StackPanel>
                        </Border>

                        <Border Height="1" Background="{DynamicResource SeparatorBrush}" Margin="0,20,0,10"/>
                        
                        <TextBlock Text="Refresh Intervals (Seconds)" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock Text="Atur interval update otomatis per detik." FontSize="12" Foreground="#999" Margin="0,0,0,10"/>

                        <UniformGrid Columns="2" Rows="2">
                             <!-- Editing -->
                             <StackPanel Spacing="5" Margin="0,0,10,10">
                                 <TextBlock Text="Editing Board" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 <NumericUpDown Value="{Binding EditingRefreshSeconds}" Minimum="5" Maximum="3600" Increment="5" FormatString="0" />
                             </StackPanel>
                             
                             <!-- Revision -->
                             <StackPanel Spacing="5" Margin="0,0,0,10">
                                 <TextBlock Text="Revision Board" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 <NumericUpDown Value="{Binding RevisionRefreshSeconds}" Minimum="5" Maximum="3600" Increment="5" FormatString="0" />
                             </StackPanel>
                             
                             <!-- Late -->
                             <StackPanel Spacing="5" Margin="0,0,10,0">
                                 <TextBlock Text="Late Board" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 <NumericUpDown Value="{Binding LateRefreshSeconds}" Minimum="5" Maximum="3600" Increment="5" FormatString="0" />
                             </StackPanel>
                             
                             <!-- Points -->
                             <StackPanel Spacing="5">
                                 <TextBlock Text="Points (Sheet)" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                 <NumericUpDown Value="{Binding PointsRefreshSeconds}" Minimum="5" Maximum="3600" Increment="5" FormatString="0" />
                             </StackPanel>
                        </UniformGrid>

                        <Button HorizontalAlignment="Right" Content="{Binding Language[General.Save]}" Command="{Binding SaveProfileCommand}" Classes="Primary" Margin="0,20,0,0"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Content Area (Extensions) -->
        <Border Grid.Row="1" Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True"
                IsVisible="{Binding IsNotificationsSelected}">
             <!-- ... Extension Content ... -->
             <Grid Margin="30"> <!-- Changed: Removed RowDefinitions (default *) -->
                 <!-- Empty State -->
                 <TextBlock Text="{Binding Language[Extensions.NoExtensions]}" 
                            Foreground="{DynamicResource TextSecondaryBrush}" 
                            HorizontalAlignment="Center" VerticalAlignment="Center">
                     <TextBlock.IsVisible>
                         <Binding Path="Extensions.Count" Converter="{x:Static ObjectConverters.IsNull}"/> <!-- Simplified check, or Convert 0 to true -->
                     </TextBlock.IsVisible>
                 </TextBlock>

                 <!-- Extension List -->
                 <ScrollViewer VerticalScrollBarVisibility="Auto">
                     <ItemsControl ItemsSource="{Binding Extensions}" Margin="0,0,0,80">
                         <ItemsControl.ItemTemplate>
                             <DataTemplate>
                                 <Border Background="{DynamicResource CardBackgroundBrush}" CornerRadius="10" Padding="15" Margin="0,0,0,10">
                                     <Grid ColumnDefinitions="Auto, *, Auto, Auto" RowDefinitions="Auto, Auto">
                                         <!-- Icon -->
                                         <Border Grid.RowSpan="2" Width="40" Height="40" CornerRadius="8" Background="{DynamicResource AccentColorBrush}" Margin="0,0,15,0">
                                             <PathIcon Data="{StaticResource IconExtension}" Foreground="White" Width="20" Height="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                         </Border>
                                         
                                         <!-- Info -->
                                         <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                             <TextBlock Text="{Binding Name}" FontWeight="Bold" Foreground="{DynamicResource TextPrimaryBrush}" FontSize="14"/>
                                             <TextBlock Text="{Binding Description}" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" TextTrimming="CharacterEllipsis"/>
                                         </StackPanel>
                                          
                                          <!-- Meta -->
                                         <StackPanel Grid.Column="1" Grid.Row="1" Orientation="Horizontal" Spacing="10" Margin="0,5,0,0">
                                             <TextBlock Text="{Binding Version, StringFormat='v{0}'}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                              <TextBlock Text="|" FontSize="11" Foreground="#444"/>
                                             <TextBlock Text="{Binding Author}" FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                         </StackPanel>

                                         <!-- Toggle -->
                                         <ToggleSwitch Grid.Column="2" IsChecked="{Binding IsEnabled}" Command="{Binding ToggleCommand}" VerticalAlignment="Center" Margin="10,0"/>
                                         
                                         <!-- Delete -->
                                         <Button Grid.Column="3" Classes="Clear" Command="{Binding DeleteCommand}" Foreground="#EF4444" VerticalAlignment="Center">
                                             <PathIcon Data="{StaticResource IconTrash}" Width="16" Height="16" Foreground="#EF4444"/>
                                         </Button>
                                     </Grid>
                                 </Border>
                             </DataTemplate>
                         </ItemsControl.ItemTemplate>
                     </ItemsControl>
                 </ScrollViewer>
                 
                 <!-- FAB (Add Button) -->
                  <Button Command="{Binding AddExtensionCommand}" 
                          Classes="Primary"
                          HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,10,10">
                      <StackPanel Orientation="Horizontal" Spacing="8">
                          <PathIcon Data="{StaticResource IconPlus}" Width="16" Height="16" Foreground="White" VerticalAlignment="Center"/>
                          <TextBlock Text="{Binding Language[Extensions.Add]}" VerticalAlignment="Center"/>
                      </StackPanel>
                  </Button>
             </Grid>
        </Border>

        <!-- Script Manager UI -->
        <Border Grid.Row="1" Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True"
                IsVisible="{Binding IsScriptsManagerSelected}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <Grid RowDefinitions="Auto, *, Auto" Margin="30">
                    <!-- Header removed as requested -->

                    <Grid Grid.Row="1" RowDefinitions="Auto, Auto" ShowGridLines="False">
                        
                        <!-- Master Scripts (Python) -->
                        <Grid Grid.Row="0" RowDefinitions="Auto, *" Margin="0,0,0,20">
                            <TextBlock Grid.Row="0" Text="Master Scripts (Python)" FontWeight="SemiBold" Margin="0,0,0,10" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Left"/>
                            
                            <Border Grid.Row="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="10" BorderBrush="{DynamicResource CardBorderBrush}" BorderThickness="1">
                                 <ItemsControl ItemsSource="{Binding MasterScripts}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="15" Margin="0,0,0,1" Background="Transparent" BorderBrush="#333" BorderThickness="0,0,0,1"
                                                    DragDrop.AllowDrop="True" DragDrop.DragOver="OnItemDragOver" DragDrop.Drop="OnItemDrop"
                                                    Tag="Master">
                                                <Grid ColumnDefinitions="Auto, Auto, *, Auto">
                                                    
                                                    <!-- Icon Hamburger -->
                                                    <PathIcon Grid.Column="0" Data="{StaticResource IconMenu}" Width="16" Height="16" Foreground="#666" VerticalAlignment="Top" Margin="0,5,15,0" 
                                                              ToolTip.Tip="Drag to Reorder" Cursor="Hand"
                                                              PointerPressed="OnHamburgerPointerPressed"/>

                                                    <!-- Icon Display / Picker -->
                                                    <Border Grid.Column="1" Width="36" Height="36" CornerRadius="8" Margin="0,0,15,0" 
                                                            Background="#15FFFFFF" BorderBrush="#333" BorderThickness="1" ClipToBounds="True" VerticalAlignment="Top">
                                                         <Panel>
                                                             <!-- View Mode -->
                                                             <Viewbox Width="18" Height="18" IsVisible="{Binding !IsEditing}">
                                                                  <Path Data="{Binding IconGeometry}" Fill="White" Stretch="Uniform" 
                                                                        IsVisible="{Binding IconGeometry, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                                             </Viewbox>
                                                             <PathIcon Data="{StaticResource IconScript}" Width="16" Height="16" Foreground="#444" 
                                                                       IsVisible="{Binding IconGeometry, Converter={x:Static ObjectConverters.IsNull}}"/>

                                                             <!-- Edit Mode -->
                                                             <Button IsVisible="{Binding IsEditing}" Command="{Binding PickIconCommand}" 
                                                                     Background="Transparent" BorderThickness="0" Padding="0" 
                                                                     HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Cursor="Hand"
                                                                     ToolTip.Tip="Select Icon">
                                                                 <Panel>
                                                                     <Viewbox Width="18" Height="18">
                                                                          <Path Data="{Binding EditIconGeometry}" Fill="{DynamicResource AccentBlueBrush}" Stretch="Uniform"
                                                                                IsVisible="{Binding EditIconGeometry, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                                                     </Viewbox>
                                                                     <PathIcon Data="{StaticResource IconPlus}" Width="14" Height="14" Foreground="#666"
                                                                               IsVisible="{Binding EditIconGeometry, Converter={x:Static ObjectConverters.IsNull}}"/>
                                                                 </Panel>
                                                             </Button>
                                                         </Panel>
                                                    </Border>

                                                    <!-- Info (View Mode) -->
                                                    <Grid Grid.Column="2" IsVisible="{Binding !IsEditing}" RowDefinitions="Auto, Auto">
                                                        <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                                            <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                            <Border Background="#333" CornerRadius="4" Padding="6,2" VerticalAlignment="Center" IsVisible="{Binding ShortCode, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                                                <TextBlock Text="{Binding ShortCode}" FontSize="12" Foreground="#AAA" FontWeight="Bold"/>
                                                            </Border>
                                                        </StackPanel>
                                                        <TextBlock Grid.Row="1" Text="{Binding OriginalName}" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,4,0,0"/>
                                                    </Grid>

                                                    <!-- Editor (Edit Mode) -->
                                                    <Grid Grid.Column="2" IsVisible="{Binding IsEditing}" ColumnDefinitions="*, 80" RowDefinitions="Auto, Auto, Auto">
                                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Display Name" FontSize="11" Foreground="#888" Margin="0,0,0,2"/>
                                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="Short Code" FontSize="11" Foreground="#888" Margin="5,0,0,2"/>

                                                        <TextBox Grid.Row="1" Grid.Column="0" Text="{Binding EditName}" Watermark="Main Text" Margin="0,0,10,0" FontSize="14" Padding="8">
                                                            <TextBox.KeyBindings>
                                                                <KeyBinding Gesture="Enter" Command="{Binding SaveRenameCommand}"/>
                                                            </TextBox.KeyBindings>
                                                        </TextBox>
                                                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding EditShortCode}" Watermark="CODE" MaxLength="4" FontSize="14" HorizontalContentAlignment="Center" Padding="8">
                                                            <TextBox.KeyBindings>
                                                                <KeyBinding Gesture="Enter" Command="{Binding SaveRenameCommand}"/>
                                                            </TextBox.KeyBindings>
                                                        </TextBox>
                                                        
                                                        <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10" Margin="0,10,0,0">
                                                            <Button Content="Cancel" Command="{Binding ToggleEditCommand}" Classes="Clear" Foreground="{DynamicResource AccentColorBrush}" FontSize="12" Padding="10,5"/>
                                                            <Button Content="Save Changes" Command="{Binding SaveRenameCommand}" Classes="Primary" FontSize="12" Padding="15,6"/>
                                                        </StackPanel>
                                                    </Grid>

                                                    <!-- Edit Button -->
                                                    <Button Grid.Column="3" Command="{Binding ToggleEditCommand}" Classes="Clear" IsVisible="{Binding !IsEditing}" Margin="10,0,0,0" ToolTip.Tip="Edit Script">
                                                        <PathIcon Data="{StaticResource IconEdit}" Width="16" Height="16" Foreground="#888"/>
                                                    </Button>

                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Border>
                        </Grid>

                        <!-- Action Scripts (JSX/PYW) -->
                        <Grid Grid.Row="1" RowDefinitions="Auto, *">
                            <TextBlock Grid.Row="0" Text="Action Scripts (JSX / PYW)" FontWeight="SemiBold" Margin="0,0,0,10" Foreground="{DynamicResource TextPrimaryBrush}" HorizontalAlignment="Left"/>
                            
                            <Border Grid.Row="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="10" BorderBrush="{DynamicResource CardBorderBrush}" BorderThickness="1">
                                    <ItemsControl ItemsSource="{Binding ActionScripts}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Padding="15" Margin="0,0,0,1" Background="Transparent" BorderBrush="{DynamicResource SeparatorBrush}" BorderThickness="0,0,0,1"
                                                        DragDrop.AllowDrop="True" DragDrop.DragOver="OnItemDragOver" DragDrop.Drop="OnItemDrop"
                                                        Tag="Action">
                                                    <Grid ColumnDefinitions="Auto, Auto, *, Auto">
                                                        
                                                        <!-- Icon Hamburger -->
                                                        <PathIcon Grid.Column="0" Data="{StaticResource IconMenu}" Width="16" Height="16" Foreground="#666" VerticalAlignment="Top" Margin="0,5,15,0" 
                                                                  ToolTip.Tip="Drag to Reorder" Cursor="Hand"
                                                                  PointerPressed="OnHamburgerPointerPressed"/>

                                                        <!-- Icon Display / Picker -->
                                                        <Border Grid.Column="1" Width="36" Height="36" CornerRadius="8" Margin="0,0,15,0" 
                                                                Background="#15FFFFFF" BorderBrush="#333" BorderThickness="1" ClipToBounds="True" VerticalAlignment="Top">
                                                             <Panel>
                                                                 <!-- View Mode -->
                                                                 <Viewbox Width="18" Height="18" IsVisible="{Binding !IsEditing}">
                                                                      <Path Data="{Binding IconGeometry}" Fill="White" Stretch="Uniform" 
                                                                            IsVisible="{Binding IconGeometry, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                                                 </Viewbox>
                                                                 <PathIcon Data="{StaticResource IconScript}" Width="16" Height="16" Foreground="#444" 
                                                                           IsVisible="{Binding IconGeometry, Converter={x:Static ObjectConverters.IsNull}}"/>

                                                                 <!-- Edit Mode -->
                                                                 <Button IsVisible="{Binding IsEditing}" Command="{Binding PickIconCommand}" 
                                                                         Background="Transparent" BorderThickness="0" Padding="0" 
                                                                         HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Cursor="Hand"
                                                                         ToolTip.Tip="Select Icon">
                                                                     <Panel>
                                                                         <Viewbox Width="18" Height="18">
                                                                              <Path Data="{Binding EditIconGeometry}" Fill="{DynamicResource AccentBlueBrush}" Stretch="Uniform"
                                                                                    IsVisible="{Binding EditIconGeometry, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                                                         </Viewbox>
                                                                         <PathIcon Data="{StaticResource IconPlus}" Width="14" Height="14" Foreground="#666"
                                                                                   IsVisible="{Binding EditIconGeometry, Converter={x:Static ObjectConverters.IsNull}}"/>
                                                                     </Panel>
                                                                 </Button>
                                                             </Panel>
                                                        </Border>

                                                        <!-- Info (View Mode) -->
                                                        <Grid Grid.Column="2" IsVisible="{Binding !IsEditing}" RowDefinitions="Auto, Auto">
                                                            <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                                                <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                                <Border Background="#333" CornerRadius="4" Padding="6,2" VerticalAlignment="Center" IsVisible="{Binding ShortCode, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                                                    <TextBlock Text="{Binding ShortCode}" FontSize="12" Foreground="#AAA" FontWeight="Bold"/>
                                                                </Border>
                                                            </StackPanel>
                                                            <TextBlock Grid.Row="1" Text="{Binding OriginalName}" FontSize="12" Foreground="#666" Margin="0,4,0,0"/>
                                                        </Grid>

                                                        <!-- Editor (Edit Mode) -->
                                                        <Grid Grid.Column="2" IsVisible="{Binding IsEditing}" ColumnDefinitions="*, 80" RowDefinitions="Auto, Auto, Auto">
                                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Display Name" FontSize="11" Foreground="#888" Margin="0,0,0,2"/>
                                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="Short Code" FontSize="11" Foreground="#888" Margin="5,0,0,2"/>

                                                            <TextBox Grid.Row="1" Grid.Column="0" Text="{Binding EditName}" Watermark="Main Text" Margin="0,0,10,0" FontSize="14" Padding="8">
                                                                <TextBox.KeyBindings>
                                                                    <KeyBinding Gesture="Enter" Command="{Binding SaveRenameCommand}"/>
                                                                </TextBox.KeyBindings>
                                                            </TextBox>
                                                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding EditShortCode}" Watermark="CODE" MaxLength="4" FontSize="14" HorizontalContentAlignment="Center" Padding="8">
                                                                <TextBox.KeyBindings>
                                                                    <KeyBinding Gesture="Enter" Command="{Binding SaveRenameCommand}"/>
                                                                </TextBox.KeyBindings>
                                                            </TextBox>
                                                            
                                                            <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10" Margin="0,10,0,0">
                                                            <Button Content="Cancel" Command="{Binding ToggleEditCommand}" Classes="Clear" Foreground="{DynamicResource AccentColorBrush}" FontSize="12" Padding="10,5"/>
                                                                <Button Content="Save Changes" Command="{Binding SaveRenameCommand}" Classes="Primary" FontSize="12" Padding="15,6"/>
                                                            </StackPanel>
                                                        </Grid>

                                                        <!-- Edit Button -->
                                                        <Button Grid.Column="3" Command="{Binding ToggleEditCommand}" Classes="Clear" IsVisible="{Binding !IsEditing}" Margin="10,0,0,0" ToolTip.Tip="Edit Script">
                                                            <PathIcon Data="{StaticResource IconEdit}" Width="16" Height="16" Foreground="#888"/>
                                                        </Button>

                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                            </Border>
                        </Grid>
                    </Grid>
                    
                </Grid>
            </ScrollViewer>
        </Border>


        <!-- Content Area (Paths) -->
        <Border Grid.Row="1" Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True"
                IsVisible="{Binding IsPathsSelected}">
             <views:PathSettingsView DataContext="{Binding PathSettingsVM}" />
        </Border>

        <!-- Content Area (About) -->
        <Border Grid.Row="1" Grid.Column="1" Background="{DynamicResource CardBackgroundBrush}" CornerRadius="20" ClipToBounds="True"
                IsVisible="{Binding IsAboutSelected}">
             <ScrollViewer>
                 <StackPanel Spacing="30" Margin="40" HorizontalAlignment="Center" VerticalAlignment="Center">
                     
                     <!-- App Logo -->
                     <Image Source="/Assets/splash_logo.png" Width="100" Height="100" HorizontalAlignment="Center"/>
                     
                     <!-- App Info -->
                     <StackPanel Spacing="5" HorizontalAlignment="Center">
                         <TextBlock Text="BMachine" FontSize="28" FontWeight="Bold" HorizontalAlignment="Center" Foreground="{DynamicResource TextPrimaryBrush}"/>
                         <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
                              <Border Background="{DynamicResource AccentColorBrush}" CornerRadius="4" Padding="6,2">
                                  <TextBlock Text="{Binding CurrentVersion, StringFormat='v{0}'}" Foreground="White" FontWeight="Bold" FontSize="12"/>
                              </Border>
                              <TextBlock Text="Photo Editing Workflow" Foreground="{DynamicResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                         </StackPanel>
                     </StackPanel>
                     
                     <!-- Update Check -->
                     <StackPanel Spacing="15" HorizontalAlignment="Center" Width="300">
                         <Button Command="{Binding CheckForUpdatesCommand}" 
                                 IsEnabled="{Binding !IsCheckingUpdate}"
                                 Classes="Primary" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Height="40">
                             <StackPanel Orientation="Horizontal" Spacing="10">
                                 <PathIcon Data="{StaticResource IconRefresh}" Width="16" Height="16" IsVisible="{Binding !IsCheckingUpdate}"/>
                                 <TextBlock Text="Check for Updates" IsVisible="{Binding !IsCheckingUpdate}"/>
                                 <TextBlock Text="Checking..." IsVisible="{Binding IsCheckingUpdate}"/>
                             </StackPanel>
                         </Button>
                         
                         <!-- Update Result -->
                         <StackPanel Spacing="10" IsVisible="{Binding UpdateStatusText, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                             <TextBlock Text="{Binding UpdateStatusText}" HorizontalAlignment="Center" Foreground="{DynamicResource TextSecondaryBrush}"/>
                             
                             <Button Command="{Binding OpenDownloadPageCommand}" 
                                     IsVisible="{Binding IsUpdateAvailable}"
                                     Classes="Accent" HorizontalAlignment="Stretch" Content="Download Update"/>
                                     
                             <TextBlock Text="{Binding UpdateReleaseNotes}" 
                                        IsVisible="{Binding IsUpdateAvailable}"
                                        Foreground="#888" FontSize="12" TextWrapping="Wrap" MaxHeight="100" TextTrimming="CharacterEllipsis"/>
                         </StackPanel>
                     </StackPanel>
                     
                     <Border Height="1" Background="{DynamicResource SeparatorBrush}" Width="400"/>
                     
                     <!-- Links -->
                     <StackPanel Orientation="Horizontal" Spacing="20" HorizontalAlignment="Center">
                         <Button Classes="Clear" Command="{Binding OpenUrlCommand}" CommandParameter="https://github.com/zhensmarks/BMachine.v2">
                             <StackPanel Orientation="Horizontal" Spacing="5">
                                 <PathIcon Data="{StaticResource IconBrandGithub}" Width="16" Height="16"/>
                                 <TextBlock Text="GitHub"/>
                             </StackPanel>
                         </Button>
                          <Button Classes="Clear" Command="{Binding OpenUrlCommand}" CommandParameter="https://github.com/zhensmarks/BMachine.v2/issues">
                             <StackPanel Orientation="Horizontal" Spacing="5">
                                 <PathIcon Data="{StaticResource IconBug}" Width="16" Height="16"/>
                                 <TextBlock Text="Report Issue"/>
                             </StackPanel>
                         </Button>
                     </StackPanel>
                     
                     <TextBlock Text="Copyright  2024-2026 Antigravity. All rights reserved." Foreground="#555" FontSize="11" HorizontalAlignment="Center"/>
                     
                 </StackPanel>
             </ScrollViewer>
        </Border>
        </Grid>
        <!-- Notification Overlay -->
        <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Grid.ColumnSpan="2"
                HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,50"
                Background="#333333" CornerRadius="8" Padding="15,10"
                IsVisible="{Binding IsStatusVisible}"
                ZIndex="99">
            <TextBlock Text="{Binding StatusMessage}" Foreground="White" FontWeight="SemiBold"/>
        </Border>
    </Grid>
</UserControl>
