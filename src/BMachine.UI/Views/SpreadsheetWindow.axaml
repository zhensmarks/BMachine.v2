<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:views="using:BMachine.UI.Views"
        mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="600"
        x:Class="BMachine.UI.Views.SpreadsheetWindow"
        Title="Spreadsheet Editor"
        Width="1000" Height="600"
        WindowStartupLocation="CenterScreen"
        CanResize="True"
        SystemDecorations="Full"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        Background="{DynamicResource SolidBackgroundFillColorBaseBrush}"
        TransparencyLevelHint="Mica">

    <Grid>
        <!-- Content Wrapper -->
        <Border Margin="0" Background="{DynamicResource CardBackgroundBrush}" 
                CornerRadius="0" BorderThickness="0">
            <Grid>
                 <!-- Title Bar / Header -->
                <Grid Height="40" VerticalAlignment="Top" Background="Transparent" ColumnDefinitions="*, Auto" PointerPressed="OnHeaderPointerPressed">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="15,0,0,0" IsHitTestVisible="False">
                         <PathIcon Data="{StaticResource IconGrid}" Width="16" Height="16" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,10,0"/>
                         <TextBlock Text="BMachine Spreadsheet" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </StackPanel>

                    <Button Grid.Column="1" Content="âœ•" Click="CloseButton_Click" 
                            Width="40" Height="40" Background="Transparent" BorderThickness="0"
                            Foreground="{DynamicResource TextSecondaryBrush}" Cursor="Hand"
                            ToolTip.Tip="Close">
                        <Button.Styles>
                            <Style Selector="Button:pointerover /template/ ContentPresenter">
                                <Setter Property="Background" Value="#C42B1C"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Style>
                            <Style Selector="Button:pressed /template/ ContentPresenter">
                                 <Setter Property="Background" Value="#A81B0C"/>
                                 <Setter Property="Foreground" Value="White"/>
                            </Style>
                        </Button.Styles>
                        <PathIcon Data="M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z" 
                                  Width="10" Height="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                    </Button>
                </Grid>

                <!-- Spreadsheet Content -->
                <views:SpreadsheetView Margin="0,40,0,0" x:Name="SpreadsheetViewControl"/>
            </Grid>
        </Border>
    </Grid>
</Window>
